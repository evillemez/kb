# Note: copy/paste the YAML below into the editor at https://ergogen.cache.works/

points:
  # apply props to all keys
  key:
    padding: cy # global choc vertical spacing
    tags:
      1u: true
    footprints:
      choc_hotswap:
        type: choc
        nets:
          from: =column_net
          to: GND
        params:
          keycaps: true
          reverse: true
          hotswap: true
      choc:
        type: choc
        anchor:
          rotate: 180
        nets:
          from: =column_net
          to: GND
        params:
          keycaps: true
          reverse: true

  mirror:
    ref: thumbs_outer_secondary
    distance: 30

  zones:
    # main section is for the alpha keys
    main:
      rotate: -20
      key:
        bind: [0,1,0,1]
      rows:
        bottom:
        home:
        top:
      columns:
        outer:
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3
        pinkie:
          spread: cx # choc horiz spacing
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3
        ring:
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3
        middle:
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3
        index:
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3
        inner:
          spread: cx # choc horiz spacing
          rows:
            bottom:
              column_net: P1
            home:
              column_net: P2
            top:
              column_net: P3

    # primary thumb keys
    thumbs:
      anchor:
        ref: main_inner_bottom
        shift: [15, -20]
        rotate: -25
      rows:
        primary:
          width: 1.5
          padding: 1.5cy-3
          rotate: 90
          tags:
            15u: true
            1u: false
        secondary:
      columns:
        inner:
          rows:
            primary:
              bind: [0, 5, 2, 0] # NOTE: these bind values are incorporating the 90deg rotation of the primary keys
              column_net: P3
            secondary:
              bind: [0, 2, 0, 0]
              column_net: P3
        outer:
          rows:
            primary:
              bind: [0, 5, 0, 0] # NOTE: these bind values are incorporating the 90deg rotation of the primary keys
              column_net: P3
            secondary:
              column_net: P3

    # thumb keys, fanned below main
    thumbfan:
      anchor:
        ref: thumbs_inner_secondary
        rotate: 20
        shift: [-70, -75]
      rows:
        main:
      columns:
        mod4:
          rotate: 30
          rows:
            main:
              bind: [0, 3, 0, 0]
              column_net: P3
        mod3:
          rotate: -6
          stagger: -1
          spread: cx+3
          rows:
            main:
              bind: [0, 3, 0, 3]
              column_net: P3
        mod2:
          rotate: -6
          stagger: -1
          spread: cx+3
          rows:
            main:
              bind: [0, 3, 0, 3]
              column_net: P3
        mod1:
          rotate: -9
          stagger: -2
          spread: cx+3
          rows:
            main:
              bind: [0, 3, 2, 3]
              column_net: P3

outlines:
  exports:

    # outlines for just the keycaps, not bound because we want to see the actual keycap sizes
    keys1u:
      - type: keys
        side: both
        size: [1cx - 0.5, 1cy - 0.5] # Choc keycaps are 17.5 x 16.5
        bound: false
        tags: [1u]    
    keys15u:
      - type: keys
        side: both
        size: [1.5cx - 0.5, 1cy - 0.5] # Choc keycaps are 17.5 x 16.5
        bound: false
        tags: [15u]
    keys: [keys1u, keys15u]

    # NOTE: not sure if this will be needed, maybe just delete it
    keyblocks:
      - type: keys
        side: both
        bound: true
        size: [1cx - 0.5 , 1cx -0.5]

    # outlines for the overall shape, using bound keys to fill in gaps, plus
    # rectangles to shape the containing outline
    outlines:
      - type: keys
        side: both
        size: [1cx - 0.5 , 1cx -0.5]
        bound: true
      # connect the key main key zones
      - type: rectangle
        size: [168, 65]
        mirror: true
        anchor:
          ref: main_outer_bottom
          rotate: 0
          shift: [-15, -15]
      # connect top area of main zones - removing the point, flat area in between
      - type: rectangle
        size: [60, 50]
        mirror: true
        anchor:
          ref: main_inner_bottom
          rotate: 20
          shift: [0, 0]
      # connect main thumb top areas
      - type: rectangle
        size: [50, 60]
        mirror: true
        anchor:
          ref: thumbs_outer_primary
          rotate: 0
          shift: [-15, -15]
      # connect main thumb bottom areas
      - type: rectangle
        size: [63, 50]
        anchor:
          ref: thumbs_outer_primary
          rotate: -45
          shift: [-16, -15]
      # connect the thumbfans zones to the main zones above
      - type: rectangle
        size: [80, 52]
        mirror: true
        anchor:
          ref: thumbfan_mod4_main
          rotate: 0
          shift: [-24, -15]

    cutout:
      - type: outline
        name: outlines
        fillet: 2

pcbs:
  elv:
    outlines:
      board:
        outline: cutout
      keycaps:
        outline: keys
        layer: Eco1.User
    footprints:
      promicro:
        type: promicro_pretty
        anchor:
          ref: main_inner_top
          shift: [50, 20]
          rotate: -70
